(function(n){var r=!1,i=!0,t={id:"Terratype.BingMapsV8",maps:[],_defaultProvider:{position:{datum:"55.4063207,10.3870147"},zoom:12,provider:{version:"release",forceHttps:!0,language:"",predefineStyling:"road",showLabels:!0,variety:{basic:!0,satellite:!1,streetView:!1},scale:{enable:!0},breadcrumb:{enable:!0},dashboard:{enable:!0},traffic:{enable:!1,legend:!1}},search:{enable:0}},ready:function(){return r},_loadMap:function(i){return{_provider:n.terratype._mergeJson(t._defaultProvider,i.provider),_center:null,_height:i.height,_maxLat:-360,_maxLng:-360,_minLat:360,_minLng:360,_maxIconSize:0}},_needTraffic:!1,_trafficLoaded:!1,_loadMarker:function(i,r,u){if(r.position){var e=n.terratype._parseLatLng(r.position.datum),f=new n.Microsoft.Maps.Location(e.latitude,e.longitude);i._center==null&&(i._center=f);r.icon&&r.icon.url&&(i.positions.push({id:id,tag:u.getAttribute("data-tag"),label:u.getAttribute("data-label-id"),position:r.position,_latlng:f,_icon:r.icon.url,_anchor:new n.Microsoft.Maps.Point(n.terratype._getAnchorHorizontal(r.icon.anchor.horizontal,r.icon.size.width),n.terratype._getAnchorVertical(r.icon.anchor.vertical,r.icon.size.height)),autoShowLabel:u.getAttribute("data-auto-show-label")?!0:!1}),f.latitude>i._maxLat&&(i._maxLat=f.latitude),f.latitude<i._minLat&&(i._minLat=f.latitude),f.longitude>i._maxLng&&(i._maxLng=f.longitude),f.longitude<i._minLng&&(i._minLng=f.longitude),r.icon.size.width>i._maxIconSize&&(i._maxIconSize=r.icon.size.width),r.icon.size.height>i._maxIconSize&&(i._maxIconSize=r.icon.size.height))}r.provider.traffic.enable==!0&&t._needTraffic==!1&&(t._needTraffic=!0,n.Microsoft.Maps.loadModule("Microsoft.Maps.Traffic",function(){t._trafficLoaded=!0}))},_prerender:function(){return t._needTraffic==t._trafficLoaded},_mapTypeIds:function(t,i,r,u){var f=[];return t&&(u!=""?f.push(n.Microsoft.Maps.MapTypeId[u]):f.push(n.Microsoft.Maps.MapTypeId.road)),i&&f.push(n.Microsoft.Maps.MapTypeId.aerial),r&&f.push(n.Microsoft.Maps.MapTypeId.streetside),f.length==0&&f.push(n.Microsoft.Maps.MapTypeId.road),f},_log2:Math.log(2),_calculateZoom:function(n){var i=document.getElementById(n._div);if(i.clientWidth<=0||i.clientHeight<=0)return 1;var r=n._maxIconSize*2,u=Math.log(1.40625*(i.clientWidth-r)/n._bound.width)/t._log2,f=Math.log(.703125*(i.clientHeight-r)/n._bound.height)/t._log2;return f<u?f:u},_render:function(r){var u,f;r._ignoreEvents=0;u=t._mapTypeIds(r._provider.variety.basic,r._provider.variety.satellite,r._provider.variety.streetView,r._provider.predefineStyling);r._bound=new Microsoft.Maps.LocationRect.fromEdges(r._maxLat,r._minLng,r._minLat,r._maxLng);r.autoFit&&(r._center=r._bound.center);r.handle=new n.Microsoft.Maps.Map(document.getElementById(r._div),{credentials:r._provider.apiKey,enableSearchLogo:!1,showBreadcrumb:r._provider.breadcrumb.enable,showCopyright:!1,showDashboard:r._provider.dashboard.enable,showMapTypeSelector:u.length>1,showScalebar:r._provider.scale.enable,disableBirdseye:!r._provider.variety.satellite,disableScrollWheelZoom:!0,labelOverlay:r._provider.showLabels?n.Microsoft.Maps.LabelOverlay.visible:n.Microsoft.Maps.LabelOverlay.hidden,allowHidingLabelsOfRoad:!r._provider.showLabels,showMapLabels:r._provider.showLabels,mapTypeId:u[0],fixedMapPosition:i,height:r._height});r.handle.setView({center:r._center,zoom:r.autoFit?t._calculateZoom(r):r.zoom,mapTypeId:u[0],labelOverlay:r._provider.showLabels?n.Microsoft.Maps.LabelOverlay.visible:n.Microsoft.Maps.LabelOverlay.hidden});r._provider.traffic.enable==!0&&(r._traffic=new n.Microsoft.Maps.Traffic.TrafficManager(r.handle),r._traffic.show(),r._provider.traffic.legend?r._traffic.showLegend():r._traffic.hideLegend());n.Microsoft.Maps.Events.addHandler(r.handle,"viewchangeend",function(){if(!(r._ignoreEvents>0)){var i=r.handle.getZoom();i!=r.zoom&&(r.zoom=i,n.terratype._callZoom(t,r,r.zoom),t.closeInfoWindows(r))}});n.Microsoft.Maps.Events.addHandler(r.handle,"click",function(){r._ignoreEvents>0||t.closeInfoWindows(r)});f=[];n.terratype._forEach(r.positions,function(i,u){u.handle=new n.Microsoft.Maps.Pushpin(u._latlng,{id:u.id,draggable:!1,icon:u._icon,anchor:u._anchor});document.getElementById(u.label)!=null?(u._info=new n.Microsoft.Maps.Infobox(u._latlng,{description:" ",visible:!1,pushpin:u.handle}),u._info._options.description=document.getElementById(u.label).innerHTML,u._info.setMap(r.handle),n.Microsoft.Maps.Events.addHandler(u.handle,"click",function(){r._ignoreEvents>0||(t.closeInfoWindows(r),u._info&&t.openInfoWindow(r,i))}),n.terratype._domDetectionType==2&&u.autoShowLabel&&n.setTimeout(function(){t.openInfoWindow(r,i)},100)):n.Microsoft.Maps.Events.addHandler(u.handle,"click",function(){n.terratype._callClick(t,r,u)});f.push(u.handle)});r.positions.length>1?(r._clusterLayer=new n.Microsoft.Maps.ClusterLayer(f),r.handle.layers.insert(r._clusterLayer)):r.handle.entities.push(r.positions[0].handle)},openInfoWindow:function(i,r){var u=i.positions[r];u._info.setOptions({visible:!0});n.terratype._callClick(t,i,u)},closeInfoWindows:function(t){n.terratype._forEach(t.positions,function(n,t){t._info!=null&&t._info.getVisible()&&t._info.setOptions({visible:!1})})},_checkResize:function(n){n.handle.getBounds().contains(n._center)||t.refresh(n)},refresh:function(r){var u;if(!(r._ignoreEvents>0)){if(r._ignoreEvents++,!i){r.handle.setView({zoom:r.zoom});var f=r.handle.getMapTypeId(),e=t._mapTypeIds(r._provider.variety.basic,r._provider.variety.satellite,r._provider.variety.streetView,r._provider.predefineStyling),o=!1;for(u=0;u!=e.length;u++)if(e[u]==f){o=!0;break}o==!1&&(f=e[0]);r.handle.setMapType(Microsoft.Maps.MapTypeId.mercator)}setTimeout(function(){i||r.handle.setMapType(f);r._ignoreEvents--;r._refreshes==0&&n.terratype._forEach(r.positions,function(i,u){u.autoShowLabel&&n.setTimeout(function(){t.openInfoWindow(r,i)},100)});(r._refreshes==0||r.recenterAfterRefresh)&&r.handle.setView({center:r._center,zoom:r.autoFit?t._calculateZoom(r):r.zoom});r._refreshes++==0?(n.terratype._opacityShow(r),n.terratype._callRender(t,r)):n.terratype._callRefresh(t,r)},1)}}},u;n.terratype&&n.terratype._addProvider?n.terratype._addProvider(t.id,t):u=n.setInterval(function(){n.terratype&&n.terratype._addProvider&&(n.terratype._addProvider(t.id,t),n.clearInterval(u))},100);n.TerratypeBingMapsV8CallbackRender=function(){n.Microsoft.Maps.loadModule("Microsoft.Maps.Clustering",function(){r=!0})}})(window);